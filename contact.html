<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Contact Us — StudyLoop</title>
    <link rel="icon" type="image/x-icon" href="./assets/studyloop-favicon.ico">
    <link rel="stylesheet" href="./index.css" />
    <link rel="stylesheet" href="./style.css" />
    <style>
      .contact-container {max-width:900px;margin:48px auto;padding:24px}
      .contact-card{background:var(--color-surface);padding:28px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,.06)}
      .contact-row{display:flex;gap:16px;flex-wrap:wrap}
      .contact-field{flex:1 1 280px;display:flex;flex-direction:column}
      .contact-field label{font-weight:600;margin-bottom:8px}
      .contact-field input,.contact-field textarea{padding:10px;border:1px solid #ddd;border-radius:6px;font-size:0.95rem}
      .contact-actions{margin-top:16px;display:flex;gap:12px;align-items:center}
      .contact-note{margin-top:12px;color:#666;font-size:0.9rem}
    </style>
  </head>
  <body>
    <main class="thq-section-padding">
      <div class="thq-section-max-width" style="width:100%;max-width:960px;margin:0 auto;">
        <a href="./index.html" class="navigation__logo" style="margin-bottom:16px;display:inline-flex;align-items:center;gap:8px;text-decoration:none;color:inherit;">
          <div class="navigation__logo-symbol" style="width:32px;height:32px;background:var(--color-primary);border-radius:8px"></div>
          <span class="navigation__logo-text">StudyLoop</span>
        </a>

        <section class="thq-card thq-box-shadow" style="padding:32px;border-radius:var(--border-radius-lg);background:var(--color-surface);">
          <h2 class="thq-heading-2">Contact Us</h2>
          <p class="thq-body-large" style="margin-top:8px;">Have a question, partnership inquiry, or report? Fill the form below or use the fallback email link.</p>

          <form id="contact-form" class="thq-grid-auto-300" method="POST" action="https://formspree.io/f/xjkldwbl" style="margin-top:20px;gap:16px;">
            <input id="name" name="name" type="text" placeholder="Your name" required class="thq-input" maxlength="100" />
            <input id="email" name="email" type="email" placeholder="you@example.com" required class="thq-input" maxlength="254" inputmode="email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" />
            <input id="subject" name="subject" type="text" placeholder="Subject (optional)" class="thq-input" style="grid-column:1/ -1;" maxlength="200" />
            <textarea id="message" name="message" rows="6" placeholder="Your message" required class="thq-input" style="grid-column:1/ -1;" maxlength="4000"></textarea>

            <div style="grid-column:1/ -1;display:flex;gap:12px;align-items:center;">
              <button type="submit" class="thq-button-filled">Send Message</button>
              <button type="button" id="clear-btn" class="thq-button-outline">Clear</button>
              <div id="form-status" aria-live="polite" style="margin-left:8px;color:var(--color-on-surface-secondary)"></div>
            </div>
          </form>

          <p class="thq-body-small" style="margin-top:16px">Fallback email: <a href="mailto:studyloop@outlook.com" class="thq-link">studyloop@outlook.com</a></p>
        </section>
      </div>
    </main>

    <script>
      (function(){
        const form = document.getElementById('contact-form')
        const status = document.getElementById('form-status')
        const clearBtn = document.getElementById('clear-btn')

        // Basic sanitization to reduce risk of reflected XSS and remove obvious SQL/meta patterns
        function sanitizeInput(str) {
          if (!str) return ''
          // remove HTML tags
          str = str.replace(/<[^>]*>/g, '')
          // remove common SQL/meta attack fragments
          str = str.replace(/(--|;|\/\*|\*\/|\b(DROP|INSERT|SELECT|DELETE|UPDATE)\b)/ig, '')
          // collapse repeated whitespace
          return str.trim()
        }

        form.addEventListener('submit', function (e) {
          const action = (form.getAttribute('action') || '').trim()

          // Sanitize inputs before submit (client-side defense-in-depth).
          const sanitizedName = sanitizeInput(form.name.value)
          const sanitizedEmail = sanitizeInput(form.email.value)
          const sanitizedSubject = sanitizeInput(form.subject.value)
          const sanitizedMessage = sanitizeInput(form.message.value)

          // Basic email validation (client-side only)
          const emailRe = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
          if (!emailRe.test(sanitizedEmail)) {
            e.preventDefault()
            status.textContent = 'Please enter a valid email address.'
            status.style.color = 'red'
            return
          }

          // Put sanitized values back into the form so what gets sent is cleaned client-side.
          form.name.value = sanitizedName
          form.email.value = sanitizedEmail
          form.subject.value = sanitizedSubject
          form.message.value = sanitizedMessage

          // If no action is configured or action still uses the placeholder, intercept and show guidance.
          if (action === '' || action.includes('your-form-id')) {
            e.preventDefault()
            status.textContent = 'Thanks — your message is ready to send. Configure a form backend (Formspree/Netlify) or use the fallback email.'
            status.style.color = 'green'
            return
          }

          // Otherwise allow native submit to proceed to the configured endpoint (Formspree).
        })

        clearBtn.addEventListener('click', function () {
          form.reset();
          status.textContent = ''
        })
      })()
    </script>
  </body>
</html>
